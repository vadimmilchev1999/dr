/* ===== Base / Theme (violet) ===== */
:root{
  --bg-1:#0b0720;
  --bg-2:#160c3a;
  --bg-3:#2a155e;
  --accent:#c77dff;
  --white:#fff;
  --shadow:0 10px 40px rgba(0,0,0,.35);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  color:var(--white);
  background: radial-gradient(1200px 800px at 15% 15%, var(--bg-3) 0%, transparent 60%),
              linear-gradient(180deg, var(--bg-1), var(--bg-2));
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans';
  overflow:hidden;
}

.hidden{ display:none !important }
.stage{ position:fixed; inset:0; display:grid; place-items:center; }

/* ===== Landscape gate ===== */
#gate{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:1000;
  background: radial-gradient(1400px 900px at 50% 0%, rgba(199,125,255,.18), transparent 60%), linear-gradient(180deg, var(--bg-1), var(--bg-2));
}
#gate .panel{
  width:min(90vw,560px); text-align:center; padding:28px 24px; border-radius:18px;
  background: rgba(255,255,255,.06); backdrop-filter: blur(10px); box-shadow: var(--shadow);
}
#gate .phone{ margin:0 auto 16px; width:110px; height:70px; border-radius:16px; border:3px solid #fff2; position:relative; transform:rotate(0deg); }
#gate .phone::before{ content:""; position:absolute; inset:8px; border-radius:12px; background: linear-gradient(180deg,#2a155e,#0b0720); }
#gate h2{ margin:6px 0 8px; font-weight:900 }
#gate p{ margin:0 0 12px; opacity:.9 }
#gate button{ border:0; border-radius:12px; padding:12px 18px; background:#ffffff14; color:#fff; font-weight:800; cursor:pointer }
#gate #hint{ margin-top:10px; font-size:14px; opacity:.85; min-height:1.2em }

/* music button */
#musicToggle{
  position:fixed; top:10px; right:12px; z-index:900;
  border:0; outline:none; border-radius:999px;
  width:44px; height:44px; display:grid; place-items:center;
  background:#ffffff14; color:#fff; cursor:pointer; box-shadow: var(--shadow);
}

/* countdown */
#countdown .num{
  font-size: clamp(64px, 16vw, 160px);
  font-weight:900; text-shadow:0 10px 30px rgba(0,0,0,.5);
  transform:scale(0.8); opacity:0; animation:countPop .9s cubic-bezier(.2,.8,.2,1) forwards;
}
@keyframes countPop{
  0%{ transform:translateY(20px) scale(.8); opacity:0 }
  60%{ transform:translateY(-8px) scale(1.08); opacity:1 }
  100%{ transform:translateY(0) scale(1); opacity:1 }
}

/* intro matrix canvas */
#fx{ position:fixed; inset:0; z-index:50; pointer-events:none }

/* phrase (letters) */
#phrase{ z-index:200; filter:drop-shadow(0 14px 28px rgba(0,0,0,.4)); }
.letter{
  font-family:'Pacifico', cursive; color:var(--accent);
  font-size: clamp(40px, 9vw, 120px);
  display:inline-block; opacity:0; transform-origin:50% 70%;
  animation:letterIn .6s cubic-bezier(.2,.8,.2,1) forwards;
  animation-delay: calc(var(--i) * 90ms);
  text-shadow: 0 1px 0 rgba(255,255,255,.12);
}
.space{ width:.5em; display:inline-block }

@keyframes letterIn{
  0%{ opacity:0; transform: translateY(26px) scale(.82) rotate(-6deg); }
  60%{ opacity:1; transform: translateY(-6px) scale(1.08) rotate(0deg); }
  100%{ opacity:1; transform: translateY(0) scale(1) rotate(0deg); }
}

/* disappear (explode out) */
.letter.out{
  transition: transform .7s ease, opacity .7s ease;
  transform: translate(var(--dx), var(--dy)) rotate(var(--rot)) scale(0.85);
  opacity: 0;
}

/* heart */
#heart{ z-index:220; }
#heart::before{
  content:""; display:block; width:min(46vmin,520px); aspect-ratio:1/1;
  background:
    radial-gradient(circle at 30% 35%, #ff6b6b, transparent 60%),
    radial-gradient(circle at 70% 35%, #ff6b6b, transparent 60%),
    conic-gradient(from 45deg at 50% 60%, #ff4d6d, #ff1e56 40%, #ff4d6d 80%, #ff4d6d);
  -webkit-clip-path: path('M0.5,0.3 C0.5,0.15 0.6,0.0 0.75,0.0 C0.95,0.0 1.0,0.2 1.0,0.35 C1.0,0.6 0.8,0.8 0.5,1.0 C0.2,0.8 0.0,0.6 0.0,0.35 C0.0,0.2 0.05,0.0 0.25,0.0 C0.4,0.0 0.5,0.15 0.5,0.3Z');
  clip-path: path('M0.5,0.3 C0.5,0.15 0.6,0.0 0.75,0.0 C0.95,0.0 1.0,0.2 1.0,0.35 C1.0,0.6 0.8,0.8 0.5,1.0 C0.2,0.8 0.0,0.6 0.0,0.35 C0.0,0.2 0.05,0.0 0.25,0.0 C0.4,0.0 0.5,0.15 0.5,0.3Z');
  transform: scale(0.001);
  filter: drop-shadow(0 18px 40px rgba(255,77,109,.35));
}
#heart.show::before{ animation: heartPulse 2s ease-in-out forwards; }
@keyframes heartPulse{
  0%{ transform: scale(0.001); opacity:0 }
  30%{ transform: scale(1.05); opacity:1 }
  60%{ transform: scale(0.95); opacity:1 }
  85%{ transform: scale(1.1); opacity:1 }
  100%{ transform: scale(1.4); opacity:0 }
}

/* stars */
#stars{ position:fixed; inset:0; z-index:40; background:radial-gradient(1400px 900px at 50% 50%, #1a1033, #050511 60%); }

/* book */
#book{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:60; }
.book{
  width:min(92vw, 1000px); height:min(76vh, 620px);
  perspective: 2000px; display:flex; gap:2px;
}
.page{
  position:relative; width:50%; height:100%;
  background:linear-gradient(180deg, #0f0a1f, #1a1033);
  color:#fff; border-radius:12px; overflow:hidden;
  transform-origin: left center; transform-style: preserve-3d;
  transition: transform .8s ease, box-shadow .3s ease;
  box-shadow: 0 6px 24px rgba(0,0,0,.45);
}
.page .inner{ position:absolute; inset:0; padding:24px; display:flex; flex-direction:column; gap:14px; }
.page img{ width:100%; height:62%; object-fit:cover; border-radius:10px; background:#222 }
.page h3{ margin:0; font-size:clamp(18px, 2.6vw, 30px) }
.page p{ margin:0; opacity:.9; font-size:clamp(14px, 1.8vw, 18px) }

.page.flipped{ transform: rotateY(-180deg) }
.page::after{ content:""; position:absolute; inset:0; background: linear-gradient(90deg, rgba(255,255,255,.06), transparent 30%, transparent 70%, rgba(0,0,0,.3)); pointer-events:none }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .letter{ animation:none !important; opacity:1 !important }
  #heart.show::before{ animation:none !important; transform: scale(1) !important; opacity:1 !important }
}
